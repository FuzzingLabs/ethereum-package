From 3d312cd3954786d6a23f72dfd8c276e02f2b5f0d Mon Sep 17 00:00:00 2001
From: Your Name <you@example.com>
Date: Tue, 20 Aug 2024 11:23:30 +0100
Subject: [PATCH] oui

---
 .kube/config                           | 44 ++++++++++++++++++++++++++
 examples/aligned.yaml                  | 43 +++++++++++++++++++++++++
 src/aligned/aggregator/aggregator.star | 44 ++++++++++++++++++++++++++
 src/aligned/aligned.star               |  3 ++
 src/aligned/batcher/batcher.star       |  0
 src/aligned/operator/operator.star     |  0
 9 files changed, 147 insertions(+), 1 deletion(-)
 create mode 100644 .kube/config
 create mode 100644 examples/aligned.yaml
 create mode 100644 src/aligned/aggregator/aggregator.star
 create mode 100644 src/aligned/aligned.star
 create mode 100644 src/aligned/batcher/batcher.star
 create mode 100644 src/aligned/operator/operator.star

diff --git a/.kube/config b/.kube/config
new file mode 100644
index 0000000..12e4c78
--- /dev/null
+++ b/.kube/config
@@ -0,0 +1,44 @@
+apiVersion: v1
+clusters:
+- cluster:
+    certificate-authority-data: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURCVENDQWUyZ0F3SUJBZ0lJV2ptTU01ZzBEWDB3RFFZSktvWklodmNOQVFFTEJRQXdGVEVUTUJFR0ExVUUKQXhNS2EzVmlaWEp1WlhSbGN6QWVGdzB5TkRBNE1Ua3dPVFV4TURCYUZ3MHpOREE0TVRjd09UVTJNREJhTUJVeApFekFSQmdOVkJBTVRDbXQxWW1WeWJtVjBaWE13Z2dFaU1BMEdDU3FHU0liM0RRRUJBUVVBQTRJQkR3QXdnZ0VLCkFvSUJBUURnN05vRUtKajVlTEJ5ZUJGK3RzenZSMDJLSkkvM0pvQ2t3Um5qVHFVQmhUWWc0UzQrcnBkVU9LN1YKZHc4M0VNdjV2T0VLSW5rVVdVeEcwUWJFUEhRVWdFQjlrR0VaRFU1ckw3TTVXRnZoKzh4b2RzVmtmK05BellRdwpsR01veFU2QmlqTm9CV0U0ZjJaZFhjOWROemdSOE5LM3NjaW8zMGJTZ3JHNzBPZVJHZ0ZCUE1GSFBGdUNDRGNNCm9GYkJOS0dja1BZcm00VEdyNityYzZmUnlFNHdrM3laNlFVbTRGQkZSN1RhTXpGNkVlNGVRQ2lSNVpsOHdqM3EKWk1QUUVVWi83cEJHWlhnZ0JId0QxTVJBK204QVo3TDhCZTdWTStUUDNvdEM1NlhBQW5BdkxPS29oOFk3SGswSwo2eTloUG1nSUFHREZKaHd6UEJKaldIOEVxTlhwQWdNQkFBR2pXVEJYTUE0R0ExVWREd0VCL3dRRUF3SUNwREFQCkJnTlZIUk1CQWY4RUJUQURBUUgvTUIwR0ExVWREZ1FXQkJSTDI4OGhjbnpDZkFpcEd0a0g3RjdPMWh2c3JUQVYKQmdOVkhSRUVEakFNZ2dwcmRXSmxjbTVsZEdWek1BMEdDU3FHU0liM0RRRUJDd1VBQTRJQkFRQ3B2MUxrS3EvcwpMM29HbjkyUit2cEduY1pmNmIxRHlQY2lnNGthdlVscklOSy9pS2VWK3RrNHBueVhNNU10Wlh0WWtKcyt4OG5YClhuazJHV3dUUE9lSms5TnJKNWlEZ1VaaVV5LzZvVG9XZ3hnTEgrN0M0NlVyMW1MZ29GNUxMRzJMd0VZOUgrZ2gKWTFIQ1VmMisvZ2tZeGYyVzZvQWcxenk4MEZqUHVjK2VqcFcyRG1PT09HN1M1YXJUQUlNMEw2bmZMRkw3OWxKWQpneno4WlJKK2lqUkM2WVR0aWt1OVJ1bTVKK2hVT1VpcWlaajRIc1ZyMVhvTEdTUjE4bFYxT2FOSW1qTExNWVRlCkl2ZGxoaXkrZ3I0TmJ1ekpQQVdHcXRTbEpMTkNrTlVybFVES3I1OGdvaDZmd0tJWHdndmkxbTRLNHNhNFRzVVIKNHZnZTA2WE1yQnpTCi0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K
+    server: https://kubernetes.docker.internal:6443
+  name: docker-desktop
+- cluster:
+    certificate-authority: C:\Users\bill_\.minikube\ca.crt
+    extensions:
+    - extension:
+        last-update: Tue, 20 Aug 2024 09:37:36 BST
+        provider: minikube.sigs.k8s.io
+        version: v1.33.1
+      name: cluster_info
+    server: https://127.0.0.1:1625
+  name: minikube
+contexts:
+- context:
+    cluster: docker-desktop
+    user: docker-desktop
+  name: docker-desktop
+- context:
+    cluster: minikube
+    extensions:
+    - extension:
+        last-update: Tue, 20 Aug 2024 09:37:36 BST
+        provider: minikube.sigs.k8s.io
+        version: v1.33.1
+      name: context_info
+    namespace: default
+    user: minikube
+  name: minikube
+current-context: minikube
+kind: Config
+preferences: {}
+users:
+- name: docker-desktop
+  user:
+    client-certificate-data: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURRakNDQWlxZ0F3SUJBZ0lJZEZ5OE5XYVdWcWt3RFFZSktvWklodmNOQVFFTEJRQXdGVEVUTUJFR0ExVUUKQXhNS2EzVmlaWEp1WlhSbGN6QWVGdzB5TkRBNE1Ua3dPVFV4TURCYUZ3MHlOVEE0TVRrd09UVTJNRGRhTURZeApGekFWQmdOVkJBb1REbk41YzNSbGJUcHRZWE4wWlhKek1Sc3dHUVlEVlFRREV4SmtiMk5yWlhJdFptOXlMV1JsCmMydDBiM0F3Z2dFaU1BMEdDU3FHU0liM0RRRUJBUVVBQTRJQkR3QXdnZ0VLQW9JQkFRRExZUGxiZUkzREZzQWMKT3hvODZDMnFWNG5SZG1IUUNLQzlhcGRUTCs4ZlJQSG5jUWtyUXU5VTlhN041cmxLa1hEdXlqOFljNSthL2QyRQpBYjdvWE1sYmg3ZFU0K3ZxSTJJNHBjT05qWTVJZGlhalc4bmJBZS91VGN6OG5GSC9BZ2w0aUN1UkJzVlV3VEdICk9XWHJqUFZPNnpUcy95eEV6Q2daZ1RHRXpQV1NGMWI2cGxzSnRQSjZ4amx1cDBUcEpwdmErZGgzQlhNSVY5WVQKUDhCMXlHUHNyZDVhbnhWTS9GWE5iU05xVi9PVU94WXpvMWpYVm9tRjFQNnRLNUZUK3J3TWFxSlltYjBGTnNnVQpqb1JYcXI3MzJVNXVScUtWTjV4dDRJa1ZtQVNhZjkzK2hKYUJ0N2pWTlg0Rm1VdnhLdE5MVEtjTXcrRi8vMkNhCjhHL3ZmaHpwQWdNQkFBR2pkVEJ6TUE0R0ExVWREd0VCL3dRRUF3SUZvREFUQmdOVkhTVUVEREFLQmdnckJnRUYKQlFjREFqQU1CZ05WSFJNQkFmOEVBakFBTUI4R0ExVWRJd1FZTUJhQUZFdmJ6eUZ5Zk1KOENLa2EyUWZzWHM3VwpHK3l0TUIwR0ExVWRFUVFXTUJTQ0VtUnZZMnRsY2kxbWIzSXRaR1Z6YTNSdmNEQU5CZ2txaGtpRzl3MEJBUXNGCkFBT0NBUUVBZVM4RjRqVGZESkhydXI4SE9neFNpc0NFQXYzL1VBTk4rRk1TTXZOS1FWdURLekQ1R3ZrOXBjd2QKdjlMMEYwZzVGa1d3cEhDUUZjb1VvZE94SHlkRHpoV1BtSG83czRPbE8xajhWZTlwQTBQYkl2eWs3VERZM2NabQpMNnlSTUx1OUlINkRsU2d0MzdRQWFKV3F2eng3VmpkWHR3Q0tOK0dVSkdJYU0vRG5pOS9YSTM1dGRDVHJGdGdxCkNuVk0xbmlDNGxnNnZxVHNXa2IyN3g2THJ6UWJudU1ZZGtUWm9KOHZjUVgxTFBTd00xVDMyMVpMKzVTZXc4V2oKWmdyWVZjdUtsQ1F0UWxzT1p6RmZzVGtsV1lVMTJQeHMwWnlXOTRTWFBVdVoyajJjUzN4Ullhc0tVM05hcEUxaApzSk1VZ1VPNkdYT0lqNUhOQi96eGRPNjBrV2ZjQ2c9PQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==
+    client-key-data: LS0tLS1CRUdJTiBSU0EgUFJJVkFURSBLRVktLS0tLQpNSUlFcEFJQkFBS0NBUUVBeTJENVczaU53eGJBSERzYVBPZ3RxbGVKMFhaaDBBaWd2V3FYVXkvdkgwVHg1M0VKCkswTHZWUFd1emVhNVNwRnc3c28vR0hPZm12M2RoQUcrNkZ6Slc0ZTNWT1ByNmlOaU9LWERqWTJPU0hZbW8xdkoKMndIdjdrM00vSnhSL3dJSmVJZ3JrUWJGVk1FeGh6bGw2NHoxVHVzMDdQOHNSTXdvR1lFeGhNejFraGRXK3FaYgpDYlR5ZXNZNWJxZEU2U2FiMnZuWWR3VnpDRmZXRXovQWRjaGo3SzNlV3A4VlRQeFZ6VzBqYWxmemxEc1dNNk5ZCjExYUpoZFQrclN1UlUvcThER3FpV0ptOUJUYklGSTZFVjZxKzk5bE9ia2FpbFRlY2JlQ0pGWmdFbW4vZC9vU1cKZ2JlNDFUVitCWmxMOFNyVFMweW5ETVBoZi85Z212QnY3MzRjNlFJREFRQUJBb0lCQVFDcGUxaVJoM2JyZW93QgplcWMwMW04bm91ZHdyR3g2aHBZZEF6U3oyQ0EzT0tjMkxaWnNmTTBoU2RPd05uTjIxcGo4QllKckIvK2JrNjhECmtNamNybVlHWnFTNmsyMUhvdEQ1VC9vVWZrQngxalFBc2o4V3lSaCt5RXJvd0FQOHRGL2NGKzNtWDNRV1d5REIKQlc0UHkxbXB1SXhVYTVraWc5ZHUyYURBZ0dTc3BsUXdIbFFGOERYVWU4OURYTU9sRGU1c0lKaTNBZ1pnT0pXaApzREtZTUdXdVlnT241Qm9Nd042NWF0c29OWGZ6WnhNV285VklIOTBuVXJ2ZlJveWhMQStyZnUvUDRCaHhhRGRICk9ieDJCalhNSFZCY0RqbmxabzJ1YVhUWEUwSGJzVFFUS2lSVHFzM21UOE5iY2lOUVErUUNlTUtyVVEyMHFpWWkKN0lNUWZRUTVBb0dCQU0yUitkOUNpZHdqZ3RUZFIxcEh0bC9jcldpWEEwUTVPOWdUK2ZvMmJhNzFFOFVhV2ptQQovZmd0WEZ3T081SjNZTUlEcmJsL0F2UUFGUDRTR1V0L3VleWRyeU8wNitYQzlmRnBOZWhmTjNGZFBkMjVFMXVWCjlQVDJHeGJ3Y1pHNGpCOWoya2VxR1ZCM3dVcjB0cWRLNTZUeVlEYm84S0FXcHlJalBUTnMvQlpuQW9HQkFQMUYKWC9seWRLdjlLYlR6dDVPTVZBSlBOVnlKVi9kSHlhbWhtOTg5TmxMV0xDc2w3VHRYZUFhci9ndUhhMzVHSGNUOAp2K0JvTEk5UGk0RzhRYW5MZVp2WU9hTVRaQUMxSHVPTmszd3BveVRlV0V1TWVSb0pjdUlFMUhDWWhGOFJyTGkwCnBGM2ZBRG90Mi9Qd2Jvem1weUtCVTJNL3hlYWdYZGl3Vks1cldnQXZBb0dBT2ZhU0hSaVc1S0tDcm1DaVVOdHQKbWdRUVJUQm5kR0lxOUpkVlllN2M2SHNrRXV5R1NqYUw1ZUZzYkd4NjhhYUZlczhzdWVRTlFoMlB6Yi91ci9JWQp5NVgrbnpQUlhCeW4ybVVQRlRGYjRiUW4wSS94M0Y0aERyMGlFRXJGeXcvZE9yQ2VDSnoydkZDNENObU5jd2hVCjNwYVUrSWFmNnBQWWxuQ1hQaHZaekxzQ2dZRUFwbXRLZUFjOElMTDJENy9CRllPMHc5dTJMWHJWd1ZkN2JDb1QKMk9sSTQ3OTFRRmpvZkFDcWpuKy9LMll0UE1qbjBNTmZkUjRlZ1lCOEk2Qkc2VUlaUTAwZCtraklnaXFCQkhiSAp2V05DbnZ3MnVsV3dVV3A2QVllNDY4OWIwM2d5clIrTmpWejFza1RsN1hGRHd2UGdTS3ovMVF4WGhvWkRoQm5CCld1YVJPZU1DZ1lBbjcrTHgwTkR0RjYzVDJsamUxay9QTUs1azB1cGJKcXN1Yis5Ym5UQ1Q2eElycmU1WGwwWjIKc21lVjlXV2VGU05oQjU1cURWVkZzSHFIRklraVJGN1A0TTZ4Y0lacEs4SXNaMWpVekVTVy9lZEREdFcxaDB3KwpndnY4dURpelNKMUM2NTNKaURPaHY1ODdqQU5lT2JNVzdmajhXUFczc2Qwb2I2MndTWkt3SEE9PQotLS0tLUVORCBSU0EgUFJJVkFURSBLRVktLS0tLQo=
+- name: minikube
+  user:
+    client-certificate: C:\Users\bill_\.minikube\profiles\minikube\client.crt
+    client-key: C:\Users\bill_\.minikube\profiles\minikube\client.key
diff --git a/examples/aligned.yaml b/examples/aligned.yaml
new file mode 100644
index 0000000..89c05f1
--- /dev/null
+++ b/examples/aligned.yaml
@@ -0,0 +1,43 @@
+participants:
+  - el_type: geth
+    el_image: ethereum/client-go:v1.13.14
+    cl_type: lighthouse
+    cl_image: sigp/lighthouse:v5.1.1
+    el_min_cpu: 1000
+    el_max_cpu: 1000
+    el_min_mem: 1024
+    el_max_mem: 1024
+    cl_min_cpu: 2000
+    cl_max_cpu: 3000
+    cl_min_mem: 2048
+    cl_max_mem: 2048
+    vc_min_cpu: 1000
+    vc_max_cpu: 1000
+    vc_min_mem: 1028
+    vc_max_mem: 1028
+    count: 1
+  - el_type: geth
+    el_image: ethereum/client-go:v1.13.14
+    cl_type: prysm
+    cl_image: gcr.io/prysmaticlabs/prysm/beacon-chain:v5.0.1
+    el_min_cpu: 1000
+    el_max_cpu: 1000
+    el_min_mem: 1024
+    el_max_mem: 1024
+    cl_min_cpu: 2000
+    cl_max_cpu: 3000
+    cl_min_mem: 2048
+    cl_max_mem: 2048
+    vc_min_cpu: 1000
+    vc_max_cpu: 1000
+    vc_min_mem: 1028
+    vc_max_mem: 1028
+    count: 1
+
+network_params:
+  deneb_fork_epoch: 1
+  num_validator_keys_per_node: 32
+#additional_services:
+#  - aligned
+persistent: true
+global_log_level: info
diff --git a/src/aligned/aggregator/aggregator.star b/src/aligned/aggregator/aggregator.star
new file mode 100644
index 0000000..9091ef9
--- /dev/null
+++ b/src/aligned/aggregator/aggregator.star
@@ -0,0 +1,44 @@
+IMAGE_NAME = ""
+SERVICE_NAME = "aligned-aggregator"
+
+ENTRYPOINT_ARGS = [""]
+
+# The min/max CPU/memory that aligned-aggregator can use
+MIN_CPU = 100
+MAX_CPU = 1000
+MIN_MEMORY = 256
+MAX_MEMORY = 512
+
+
+def launch_aggregator(
+    plan,
+    prefunded_addresses,
+    el_uri,
+    global_node_selectors,
+):
+    plan.print("Launching aligned-aggregator")
+    config = get_config(
+        prefunded_addresses,
+        el_uri,
+        global_node_selectors,
+    )
+    plan.add_service(SERVICE_NAME, config)
+
+
+def get_config(
+    prefunded_addresses,
+    el_uri,
+    node_selectors,
+):
+    return ServiceConfig(
+        image=IMAGE_NAME,
+        entrypoint=ENTRYPOINT_ARGS,
+        cmd=[
+            "",
+        ],
+        min_cpu=MIN_CPU,
+        max_cpu=MAX_CPU,
+        min_memory=MIN_MEMORY,
+        max_memory=MAX_MEMORY,
+        node_selectors=node_selectors,
+    )
diff --git a/src/aligned/aligned.star b/src/aligned/aligned.star
new file mode 100644
index 0000000..0daa15f
--- /dev/null
+++ b/src/aligned/aligned.star
@@ -0,0 +1,3 @@
+aggregator = import_module("./aggregator/aggregator.star")
+batcher = import_module("./batcher/batcher.star")
+operator = import_module("./operator/operator.star")
diff --git a/src/aligned/batcher/batcher.star b/src/aligned/batcher/batcher.star
new file mode 100644
index 0000000..e69de29
diff --git a/src/aligned/operator/operator.star b/src/aligned/operator/operator.star
new file mode 100644
index 0000000..e69de29
